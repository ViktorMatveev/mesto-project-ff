(()=>{"use strict";var e=null;function t(t){return t.classList.add("popup_is-opened"),e=t,t.addEventListener("click",n),window.addEventListener("keydown",r),e}function n(t){t.target===e&&o(e)}function o(e){e.classList.remove("popup_is-opened"),e.removeEventListener("click",n),window.removeEventListener("keydown",r)}function r(t){"Escape"===t.key&&o(e)}var c=document.querySelector("#card-template").content,a=document.querySelector(".popup_type_delete-card"),u={};function i(e,n,o,r,i){var s=c.querySelector(".card").cloneNode(!0),l=s.querySelector(".card__delete-button"),d=s.querySelector(".card__like-button"),p=s.querySelector(".card__like-counter"),f=s.querySelector(".card__image"),_=s.querySelector(".card__title");return f.src=e.link,f.alt=e.name,_.textContent=e.name,p.textContent=e.likes.length,n!==e.owner._id&&l.remove(),l.addEventListener("click",(function(){t(a),u.card=s,u.id=e._id})),e.likes.some((function(e){return e._id===n}))?d.classList.add("card__like-button_is-active"):d.classList.remove("card__like-button_is-active"),d.addEventListener("click",(function(t){o(function(e){return!!e.classList.contains("card__like-button_is-active")}(t.target),e,s)})),s.addEventListener("click",i),s}function s(e,t){t.querySelector(".card__like-counter").textContent=e.likes.length,t.querySelector(".card__like-button").classList.toggle("card__like-button_is-active")}var l={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function d(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(l.inputErrorClass),o.textContent=n,o.classList.add(l.errorClass)}function p(e,t){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(l.inputErrorClass),n.classList.remove(l.errorClass),n.textContent=""}function f(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(l.inactiveButtonClass)):(t.disabled=!0,t.classList.add(l.inactiveButtonClass))}function _(e){var t=Array.from(e.querySelectorAll(l.inputSelector));t.forEach((function(t){p(e,t)})),f(t,e.querySelector(l.submitButtonSelector))}function m(e,t,n,o){fetch(n.value).then((function(r){r.ok&&r.headers.get("Content-Type").includes("image")?e():(d(t,n,"URL не передает изображение"),o.disabled=!0,o.classList.add(l.inactiveButtonClass),o.textContent="Сохранить")})).catch((function(e){console.log("Oшибка запроса",e)}))}var v,h={baseUrl:"https://nomoreparties.co/v1/wff-cohort-9",headers:{authorization:"6822d671-11c6-4eec-8c5d-59a6a77e5591","Content-Type":"application/json"}},y=function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))},S=function(e){return fetch("".concat(h.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:h.headers}).then((function(e){return y(e)}))},b=function(e){return fetch("".concat(h.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:h.headers}).then((function(e){return y(e)}))},q=document.querySelector(".places__list"),C=document.querySelector(".profile__edit-button"),L=document.querySelector(".profile__add-button"),g=Array.from(document.querySelectorAll(".popup__close")),E=Array.from(document.querySelectorAll(".popup")),k=document.querySelector(".popup_type_avatar"),x=document.querySelector(".popup_type_edit"),A=document.querySelector(".popup_type_new-card"),U=document.querySelector(".popup_type_image"),w=document.querySelector(".popup_type_delete-card"),T=U.querySelector(".popup__caption"),B=U.querySelector(".popup__image"),P=document.querySelector(".profile__title"),O=document.querySelector(".profile__description"),N=document.querySelector(".profile__image");function j(e,t,n){e?b(t._id).then((function(e){return s(e,n)})).catch((function(e){console.log(e)})):S(t._id).then((function(e){return s(e,n)})).catch((function(e){console.log(e)}))}function D(e){e.target.classList.contains("card__image")&&(t(U),B.src=e.target.src,B.alt=e.target.alt,T.textContent=e.target.alt)}E.forEach((function(e){return e.classList.add("popup_is-animated")})),N.addEventListener("click",(function(){J.reset(),_(k.querySelector(".popup__form")),t(k)})),C.addEventListener("click",(function(){R.value=P.textContent,F.value=O.textContent,_(x.querySelector(".popup__form")),t(x)})),L.addEventListener("click",(function(){I.reset(),_(A.querySelector(".popup__form")),t(A)})),g.forEach((function(e){return e.addEventListener("click",(function(){o(e.closest(".popup"))}))}));var J=document.forms["edit-avatar"],M=J.avatar,H=J.querySelector(".popup__button");function V(e){var t;(t=M.value,fetch("".concat(h.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:h.headers,body:JSON.stringify({avatar:t})}).then((function(e){return y(e)}))).then((function(e){N.style="background-image: url(".concat(e.avatar,")")})).catch((function(e){console.log(e)})),o(k),H.textContent="Сохранить"}J.addEventListener("submit",(function(){H.textContent="Сохранение...",m(V,J,M,H)}));var z=document.forms["edit-profile"],R=z.name,F=z.description,G=z.querySelector(".popup__button");z.addEventListener("submit",(function(){var e,t;G.textContent="Сохранение...",(e=R.value,t=F.value,fetch("".concat(h.baseUrl,"/users/me"),{method:"PATCH",headers:h.headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return y(e)}))).then((function(e){P.textContent=e.name,O.textContent=e.about,o(x),G.textContent="Сохранить"})).catch((function(e){console.log(e)}))}));var I=document.forms["new-place"],K=I["place-name"],Q=I.link,W=I.querySelector(".popup__button");function X(e){var t,n;(t=K.value,n=Q.value,fetch("".concat(h.baseUrl,"/cards"),{method:"POST",headers:h.headers,body:JSON.stringify({name:t,link:n})}).then((function(e){return y(e)}))).then((function(e){var t=i(e,v,j,0,D);q.prepend(t),o(A),W.textContent="Сохранить"})).catch((function(e){console.log(e)}))}I.addEventListener("submit",(function(){W.textContent="Сохранение...",m(X,I,Q,W)}));var Y=document.forms["delete-card"];function Z(e){var t;(t=e.id,fetch("".concat(h.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:h.headers}).then((function(e){return y(e)}))).then((function(t){!function(e){e.remove()}(e.card),o(w)})).catch((function(e){console.log(e)}))}Y.querySelector(".popup__button"),Y.addEventListener("submit",(function(){Z(u)})),Array.from(document.querySelectorAll(l.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(l.inputSelector)),n=e.querySelector(l.submitButtonSelector);f(t,n),t.forEach((function(o){o.addEventListener("input",(function(){!function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?p(e,t):d(e,t,t.validationMessage)}(e,o),f(t,n)}))}))}(e)})),Promise.all([fetch("".concat(h.baseUrl,"/users/me"),{headers:h.headers}).then((function(e){return y(e)})),fetch("".concat(h.baseUrl,"/cards"),{headers:h.headers}).then((function(e){return y(e)}))]).then((function(e){var t=e[0],n=e[1];P.textContent=t.name,O.textContent=t.about,N.style="background-image: url(".concat(t.avatar,")"),v=t._id,function(e){e.forEach((function(e){var t=i(e,v,j,0,D);q.append(t)}))}(n)})).catch((function(e){console.log(e)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2RDLEVBQVFELEVBQU8sR0FFcEI1QyxFQUFZOUUsWUFBY2dHLEVBQUtqRyxLQUM3QmdGLEVBQVcvRSxZQUFjZ0csRUFBS08sTUFDOUJ2QixFQUFVaUIsTUFBUSx5QkFBSHZFLE9BQTRCc0UsRUFBS0QsT0FBTSxLQUN0RHhDLEVBQVd5QyxFQUFLNUYsSUFPdkIsU0FBbUJ1SCxHQUNqQkEsRUFBTW5GLFNBQVEsU0FBQ3hELEdBQ2IsSUFBTUssRUFBY04sRUFDbEJDLEVBQ0F1RSxFQUNBckUsRUFDQUMsRUFDQUMsR0FFRmdGLEVBQVd3RCxPQUFPdkksRUFDcEIsR0FDRixDQWpCSXdJLENBQVVGLEVBQ1osSUFDQ3hFLE9BQU0sU0FBQ0MsR0FDTkMsUUFBUUMsSUFBSUYsRUFDZCxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC8uL3NyYy9zY3JpcHRzL2Nvbm1wb25lbnRzL21vZGFsLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QvLi9zcmMvc2NyaXB0cy9jb25tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QvLi9zcmMvc2NyaXB0cy9jb25tcG9uZW50cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QvLi9zcmMvc2NyaXB0cy9jb25tcG9uZW50cy9hcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC8uL3NyYy9zY3JpcHRzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImxldCBjdXJyZW50UG9wdXAgPSBudWxsO1xyXG5mdW5jdGlvbiBvcGVuTW9kYWwocG9wdXApIHtcclxuICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9pcy1vcGVuZWQnKTtcclxuICBjdXJyZW50UG9wdXAgPSBwb3B1cDtcclxuICBwb3B1cC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrSGFuZGxlcik7XHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBrZXlIYW5kbGVyKTtcclxuICByZXR1cm4gY3VycmVudFBvcHVwO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbGlja0hhbmRsZXIoZXZ0KSB7XHJcbiAgaWYgKGV2dC50YXJnZXQgPT09IGN1cnJlbnRQb3B1cCkge1xyXG4gICAgY2xvc2VNb2RhbChjdXJyZW50UG9wdXApO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VNb2RhbChwb3B1cCkge1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX2lzLW9wZW5lZCcpO1xyXG4gIHBvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xpY2tIYW5kbGVyKTtcclxuICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleUhhbmRsZXIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBrZXlIYW5kbGVyKGV2dCkge1xyXG4gIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xyXG4gICAgY2xvc2VNb2RhbChjdXJyZW50UG9wdXApO1xyXG4gIH1cclxufVxyXG5leHBvcnQgeyBvcGVuTW9kYWwsIGNsb3NlTW9kYWwgfTtcclxuIiwiaW1wb3J0IHsgb3Blbk1vZGFsIH0gZnJvbSAnLi9tb2RhbCc7XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZC10ZW1wbGF0ZScpLmNvbnRlbnQ7XHJcbmNvbnN0IHBvcHVwRGVsZXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZGVsZXRlLWNhcmQnKTtcclxubGV0IGNhcmRUb0RlbGV0ZSA9IHt9O1xyXG5cclxuZnVuY3Rpb24gY3JhZXRlQ2FyZChcclxuICBjYXJkRGF0YSxcclxuICB1c2VySWQsXHJcbiAgaGFuZGxlTGlrZUNhcmQsXHJcbiAgaGFuZGxlRGVsZXRlQ2FyZCxcclxuICBvcGVuSW1nUG9wdXBcclxuKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmNhcmQnKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgY29uc3QgZGVsZXRlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcclxuICBjb25zdCBsaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbiAgY29uc3QgbGlrZUNvdW50ZXIgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudGVyJyk7XHJcbiAgY29uc3QgY2FyZEltYWdlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJyk7XHJcbiAgY29uc3QgY2FyZFRpdGxlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJyk7XHJcblxyXG4gIGNhcmRJbWFnZS5zcmMgPSBjYXJkRGF0YS5saW5rO1xyXG4gIGNhcmRJbWFnZS5hbHQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XHJcbiAgbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSBjYXJkRGF0YS5saWtlcy5sZW5ndGg7XHJcblxyXG4gIC8vINGD0LTQsNC70Y/QtdC8INC60L7RgNC30LjQvdC60YMg0YEg0YfRg9C20L7QuSDQutCw0YDRgtC+0YfQutC4XHJcblxyXG4gIGlmICh1c2VySWQgIT09IGNhcmREYXRhLm93bmVyLl9pZCkge1xyXG4gICAgZGVsZXRlQnV0dG9uLnJlbW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgLy8g0YHQu9GD0YjQsNGC0LXQu9GMINC90LAg0LrQvdC+0L/QutGDINGD0LTQsNC70LXQvdC40Y9cclxuXHJcbiAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKHBvcHVwRGVsZXRlKTtcclxuICAgIGNhcmRUb0RlbGV0ZS5jYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgICBjYXJkVG9EZWxldGUuaWQgPSBjYXJkRGF0YS5faWQ7XHJcbiAgfSk7XHJcblxyXG4gIC8vINC+0LHRgNCw0LHQvtGC0YfQuNC6INC70LDQudC60LAg0L/RgNC4INC30LDQs9GA0YPQutC1INGB0YLRgNCw0L3QuNGG0YtcclxuXHJcbiAgaWYgKGNhcmREYXRhLmxpa2VzLnNvbWUoKGxpa2VyKSA9PiBsaWtlci5faWQgPT09IHVzZXJJZCkpIHtcclxuICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgfVxyXG5cclxuICAvLyDRgdC70YPRiNCw0YLQtdC70Ywg0L3QsCDQutC90L7Qv9C60YMg0LvQsNC50LrQsFxyXG5cclxuICBsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xyXG4gICAgaGFuZGxlTGlrZUNhcmQodG9nZ2xlSXNMaWtlZChldnQudGFyZ2V0KSwgY2FyZERhdGEsIGNhcmRFbGVtZW50KTtcclxuICB9KTtcclxuXHJcbiAgLy8g0YHQu9GD0YjQsNGC0LXQu9GMINC90LAg0LrQsNGA0YLQuNC90LrRg1xyXG5cclxuICBjYXJkRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5JbWdQb3B1cCk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9nZ2xlSXNMaWtlZChsaWtlQnV0dG9uKSB7XHJcbiAgcmV0dXJuIGxpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKVxyXG4gICAgPyB0cnVlXHJcbiAgICA6IGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjaGFuZ2VMaWtlKHVwZGF0ZWRDYXJkLCBjYXJkRWxlbWVudCkge1xyXG4gIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50ZXInKS50ZXh0Q29udGVudCA9XHJcbiAgICB1cGRhdGVkQ2FyZC5saWtlcy5sZW5ndGg7XHJcbiAgY2FyZEVsZW1lbnRcclxuICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKVxyXG4gICAgLmNsYXNzTGlzdC50b2dnbGUoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZWxldGVDYXJkKGNhcmQpIHtcclxuICBjYXJkLnJlbW92ZSgpO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gIGNhcmRUZW1wbGF0ZSxcclxuICBjcmFldGVDYXJkLFxyXG4gIHRvZ2dsZUlzTGlrZWQsXHJcbiAgZGVsZXRlQ2FyZCxcclxuICBjaGFuZ2VMaWtlLFxyXG4gIGNhcmRUb0RlbGV0ZSxcclxufTtcclxuIiwiY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxyXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fYnV0dG9uJyxcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZScsXHJcbn07XHJcblxyXG5mdW5jdGlvbiBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh2YWxpZGF0aW9uQ29uZmlnLmVycm9yQ2xhc3MpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KSB7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHZhbGlkYXRpb25Db25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1ZhbGlkKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQpIHtcclxuICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnBhdHRlcm5NaXNtYXRjaCkge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yTWVzc2FnZSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGlucHV0RWxlbWVudC5zZXRDdXN0b21WYWxpZGl0eSgnJyk7XHJcbiAgfVxyXG5cclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCkge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuaW5wdXRTZWxlY3RvcilcclxuICApO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgdmFsaWRhdGlvbkNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICk7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGlzVmFsaWQoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuZm9ybVNlbGVjdG9yKVxyXG4gICk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50KTtcclxuICB9KTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCkge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHZhbGlkYXRpb25Db25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhclZhbGlkYXRpb24oZm9ybSkge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvbkNvbmZpZy5pbnB1dFNlbGVjdG9yKVxyXG4gICk7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybSwgaW5wdXRFbGVtZW50KTtcclxuICB9KTtcclxuICBjb25zdCBmb3JtQnV0dG9uID0gZm9ybS5xdWVyeVNlbGVjdG9yKHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgZm9ybUJ1dHRvbik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzSW1hZ2VMaW5rKGhhbmRsZUZ1bmN0aW9uLCBmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBidXR0b25FbGVtZW50KSB7XHJcbiAgZmV0Y2goaW5wdXRFbGVtZW50LnZhbHVlKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rICYmIHJlcy5oZWFkZXJzLmdldCgnQ29udGVudC1UeXBlJykuaW5jbHVkZXMoJ2ltYWdlJykpIHtcclxuICAgICAgICBoYW5kbGVGdW5jdGlvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9ICdVUkwg0L3QtSDQv9C10YDQtdC00LDQtdGCINC40LfQvtCx0YDQsNC20LXQvdC40LUnO1xyXG4gICAgICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSk7XHJcbiAgICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHZhbGlkYXRpb25Db25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coJ0/RiNC40LHQutCwINC30LDQv9GA0L7RgdCwJywgZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgeyBlbmFibGVWYWxpZGF0aW9uLCBjbGVhclZhbGlkYXRpb24sIHZhbGlkYXRpb25Db25maWcsIGlzSW1hZ2VMaW5rIH07XHJcbiIsIi8vIC0t0YDQsNCx0L7RgtCwINGBIEFQSS0tXHJcblxyXG4vLyDQotC+0LrQtdC9OiA2ODIyZDY3MS0xMWM2LTRlZWMtOGM1ZC01OWE2YTc3ZTU1OTFcclxuLy8g0JjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0LPRgNGD0L/Qv9GLOiB3ZmYtY29ob3J0LTlcclxuXHJcbmNvbnN0IGNvbmZpZyA9IHtcclxuICBiYXNlVXJsOiAnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtOScsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogJzY4MjJkNjcxLTExYzYtNGVlYy04YzVkLTU5YTZhNzdlNTU5MScsXHJcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gIH0sXHJcbn07XHJcblxyXG5jb25zdCBjaGVja1Jlc3BvbnNlID0gKHJlcykgPT4ge1xyXG4gIGlmIChyZXMub2spIHtcclxuICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyDQtdGB0LvQuCDQvtGI0LjQsdC60LAsINC+0YLQutC70L7QvdGP0LXQvCDQv9GA0L7QvNC40YFcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8g0LfQsNC/0YDQvtGBINC90LAg0L/QvtC70YPRh9C10L3QuNC1INC60LDRgNGC0L7Rh9C10LpcclxuXHJcbmNvbnN0IGdldEluaXRpYWxDYXJkcyA9ICgpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgfSkudGhlbigocmVzKSA9PiBjaGVja1Jlc3BvbnNlKHJlcykpO1xyXG59O1xyXG5cclxuLy8g0LfQsNC/0YDQvtGBINC90LAg0LjQvdGE0L4g0L4g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9C1XHJcblxyXG5jb25zdCBnZXRVc2VySW5mbyA9ICgpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgfSkudGhlbigocmVzKSA9PiBjaGVja1Jlc3BvbnNlKHJlcykpO1xyXG59O1xyXG5cclxuLy8g0LfQsNC/0YDQvtGBINC90LAg0LjQt9C80LXQvdC10L3QuNC1INC40L3RhNC+0YDQvNCw0YbQuNC4INC+INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvQtVxyXG5cclxuY29uc3QgdXBkYXRlVXNlckluZm8gPSAodXNlck5hbWUsIHVzZXJBYm91dCkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZTogdXNlck5hbWUsIGFib3V0OiB1c2VyQWJvdXQgfSksXHJcbiAgfSkudGhlbigocmVzKSA9PiBjaGVja1Jlc3BvbnNlKHJlcykpO1xyXG59O1xyXG5cclxuLy8g0LfQsNC/0YDQvtGBINC90LAg0LjQt9C80LXQvdC10L3QuNC1INCw0LLQsNGC0LDRgNCwINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xyXG5cclxuY29uc3QgdXBkYXRlVXNlckF2YXRhciA9ICh1c2VyQXZhdGFyKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiB1c2VyQXZhdGFyIH0pLFxyXG4gIH0pLnRoZW4oKHJlcykgPT4gY2hlY2tSZXNwb25zZShyZXMpKTtcclxufTtcclxuXHJcbi8vINC30LDQv9GA0L7RgSDQvdCwINC00L7QsdCw0LLQu9C10L3QuNC1INC60LDRgNGC0L7Rh9C60Lgg0L3QsCDRgdC10YDQstC10YBcclxuXHJcbmNvbnN0IGFkZE5ld0NhcmRSZXF1ZXN0ID0gKGNhcmROYW1lLCBjYXJkTGluaykgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lOiBjYXJkTmFtZSwgbGluazogY2FyZExpbmsgfSksXHJcbiAgfSkudGhlbigocmVzKSA9PiBjaGVja1Jlc3BvbnNlKHJlcykpO1xyXG59O1xyXG5cclxuLy8g0LfQsNC/0YDQvtGBINC90LAg0LTQvtCx0LDQu9C10L3QuNC1INC70LDQudC60LBcclxuXHJcbmNvbnN0IGFkZExpa2VSZXF1ZXN0ID0gKGNhcmRJZCkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgbWV0aG9kOiAnUFVUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gIH0pLnRoZW4oKHJlcykgPT4gY2hlY2tSZXNwb25zZShyZXMpKTtcclxufTtcclxuXHJcbi8vINC30LDQv9GA0L7RgSDQvdCwINGB0L3Rj9GC0LjQtSDQu9Cw0LnQutCwXHJcblxyXG5jb25zdCByZW1vdmVMaWtlUmVxdWVzdCA9IChjYXJkSWQpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICB9KS50aGVuKChyZXMpID0+IGNoZWNrUmVzcG9uc2UocmVzKSk7XHJcbn07XHJcblxyXG4vLyDQt9Cw0L/RgNC+0YEg0L3QsCDRg9C00LDQu9C10L3QuNC1INC60LDRgNGC0L7Rh9C60LhcclxuXHJcbmNvbnN0IHJlbW92ZUNhcmQgPSAoY2FyZElkKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgfSkudGhlbigocmVzKSA9PiBjaGVja1Jlc3BvbnNlKHJlcykpO1xyXG59O1xyXG5cclxuZXhwb3J0IHtcclxuICBnZXRJbml0aWFsQ2FyZHMsXHJcbiAgZ2V0VXNlckluZm8sXHJcbiAgdXBkYXRlVXNlckluZm8sXHJcbiAgdXBkYXRlVXNlckF2YXRhcixcclxuICBhZGROZXdDYXJkUmVxdWVzdCxcclxuICBhZGRMaWtlUmVxdWVzdCxcclxuICByZW1vdmVMaWtlUmVxdWVzdCxcclxuICByZW1vdmVDYXJkLFxyXG59O1xyXG4iLCJpbXBvcnQgJy4uL3BhZ2VzL2luZGV4LmNzcyc7XHJcblxyXG5pbXBvcnQge1xyXG4gIGNyYWV0ZUNhcmQsXHJcbiAgZGVsZXRlQ2FyZCxcclxuICBjaGFuZ2VMaWtlLFxyXG4gIGNhcmRUb0RlbGV0ZSxcclxufSBmcm9tICcuL2Nvbm1wb25lbnRzL2NhcmQnO1xyXG5cclxuaW1wb3J0IHsgb3Blbk1vZGFsLCBjbG9zZU1vZGFsIH0gZnJvbSAnLi9jb25tcG9uZW50cy9tb2RhbCc7XHJcblxyXG5pbXBvcnQge1xyXG4gIGVuYWJsZVZhbGlkYXRpb24sXHJcbiAgY2xlYXJWYWxpZGF0aW9uLFxyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgaXNJbWFnZUxpbmssXHJcbn0gZnJvbSAnLi9jb25tcG9uZW50cy92YWxpZGF0aW9uJztcclxuXHJcbmltcG9ydCB7XHJcbiAgZ2V0SW5pdGlhbENhcmRzLFxyXG4gIGdldFVzZXJJbmZvLFxyXG4gIHVwZGF0ZVVzZXJJbmZvLFxyXG4gIHVwZGF0ZVVzZXJBdmF0YXIsXHJcbiAgYWRkTmV3Q2FyZFJlcXVlc3QsXHJcbiAgYWRkTGlrZVJlcXVlc3QsXHJcbiAgcmVtb3ZlTGlrZVJlcXVlc3QsXHJcbiAgcmVtb3ZlQ2FyZCxcclxufSBmcm9tICcuL2Nvbm1wb25lbnRzL2FwaSc7XHJcblxyXG5sZXQgbXlVc2VySWQ7XHJcbmNvbnN0IHBsYWNlc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19saXN0Jyk7XHJcblxyXG4vLyAtYnV0dG9ucy1cclxuXHJcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuY29uc3QgY2xvc2VCdXR0b25zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2Nsb3NlJykpO1xyXG5cclxuLy8gLXBvcHVwcy1cclxuXHJcbmNvbnN0IHBvcHVwcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwJykpO1xyXG5jb25zdCBwb3B1cEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2F2YXRhcicpO1xyXG5jb25zdCBwb3B1cFByb2ZpbGVFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdCcpO1xyXG5jb25zdCBwb3B1cE5ld0NhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9uZXctY2FyZCcpO1xyXG5jb25zdCBwb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfaW1hZ2UnKTtcclxuY29uc3QgcG9wdXBEZWxldGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9kZWxldGUtY2FyZCcpO1xyXG5jb25zdCBjYXJkVGl0bGUgPSBwb3B1cEltYWdlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2FwdGlvbicpO1xyXG5jb25zdCBzY2FsZWRJbWcgPSBwb3B1cEltYWdlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJyk7XHJcbmNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZGVzY3JpcHRpb24nKTtcclxuY29uc3QgYXZhdGFySW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XHJcblxyXG5wb3B1cHMuZm9yRWFjaCgocG9wdXApID0+IHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX2lzLWFuaW1hdGVkJykpO1xyXG5cclxuLy8g0YHQu9GD0YjQsNGC0LXQu9GMINC+0LHRgNCw0LHQvtGC0YfQuNC60LAg0LvQsNC50LrQsFxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNhcmQoc3RhdHVzLCBjYXJkRGF0YSwgY2FyZCkge1xyXG4gIGlmICghc3RhdHVzKSB7XHJcbiAgICBhZGRMaWtlUmVxdWVzdChjYXJkRGF0YS5faWQpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IGNoYW5nZUxpa2UocmVzLCBjYXJkKSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpOyAvLyDQstGL0LLQvtC00LjQvCDQvtGI0LjQsdC60YMg0LIg0LrQvtC90YHQvtC70YxcclxuICAgICAgfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJlbW92ZUxpa2VSZXF1ZXN0KGNhcmREYXRhLl9pZClcclxuICAgICAgLnRoZW4oKHJlcykgPT4gY2hhbmdlTGlrZShyZXMsIGNhcmQpKVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC+0LTQuNC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gICAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0t0LLRi9C30L7QsiDQuCDQt9Cw0YDRi9GC0LjQtSDQvNC+0LTQsNC70YzQvdGL0YUg0L7QutC+0L0tLVxyXG4vLyDQsNCy0LDRgtCw0YBcclxuYXZhdGFySW1nLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIGZvcm1OZXdBdmF0YXIucmVzZXQoKSxcclxuICAgIGNsZWFyVmFsaWRhdGlvbihwb3B1cEF2YXRhci5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKSksXHJcbiAgICBvcGVuTW9kYWwocG9wdXBBdmF0YXIpO1xyXG59KTtcclxuXHJcbi8vINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40LUg0L/RgNC+0YTQuNC70Y9cclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgbmFtZS52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGpvYi52YWx1ZSA9IHByb2ZpbGVKb2IudGV4dENvbnRlbnQ7XHJcbiAgY2xlYXJWYWxpZGF0aW9uKHBvcHVwUHJvZmlsZUVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJykpLFxyXG4gICAgb3Blbk1vZGFsKHBvcHVwUHJvZmlsZUVkaXQpO1xyXG59KTtcclxuXHJcbi8vINC90L7QstC+0LUg0LzQtdGB0YLQvlxyXG5cclxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gIGZvcm1OZXdQbGFjZS5yZXNldCgpLFxyXG4gICAgY2xlYXJWYWxpZGF0aW9uKHBvcHVwTmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKSksXHJcbiAgICBvcGVuTW9kYWwocG9wdXBOZXdDYXJkKTtcclxufSk7XHJcblxyXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PlxyXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIGNsb3NlTW9kYWwoYnV0dG9uLmNsb3Nlc3QoJy5wb3B1cCcpKTtcclxuICB9KVxyXG4pO1xyXG5cclxuLy8g0L/QvtC/0LDQvyDRgSDQutCw0YDRgtC40L3QutC+0LlcclxuXHJcbmZ1bmN0aW9uIG9wZW5JbWdQb3B1cChldnQpIHtcclxuICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NhcmRfX2ltYWdlJykpIHtcclxuICAgIG9wZW5Nb2RhbChwb3B1cEltYWdlKTtcclxuICAgIHNjYWxlZEltZy5zcmMgPSBldnQudGFyZ2V0LnNyYztcclxuICAgIHNjYWxlZEltZy5hbHQgPSBldnQudGFyZ2V0LmFsdDtcclxuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGV2dC50YXJnZXQuYWx0O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS3QoNCw0LHQvtGC0LAg0YEg0YTQvtGA0LzQsNC80LgtLVxyXG5cclxuLy8g0YHQvNC10L3QuNGC0Ywg0LDQstCw0YLQsNGAXHJcblxyXG5jb25zdCBmb3JtTmV3QXZhdGFyID0gZG9jdW1lbnQuZm9ybXNbJ2VkaXQtYXZhdGFyJ107XHJcbmNvbnN0IGxpbmtBdmF0YXIgPSBmb3JtTmV3QXZhdGFyWydhdmF0YXInXTtcclxuY29uc3Qgc2F2ZUF2YXRhckJ1dHRvbiA9IGZvcm1OZXdBdmF0YXIucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUZvcm1OZXdBdmF0YXJTdWJtaXQoZXZ0KSB7XHJcbiAgdXBkYXRlVXNlckF2YXRhcihsaW5rQXZhdGFyLnZhbHVlKVxyXG4gICAgLnRoZW4oKHVzZXIpID0+IHtcclxuICAgICAgYXZhdGFySW1nLnN0eWxlID0gYGJhY2tncm91bmQtaW1hZ2U6IHVybCgke3VzZXIuYXZhdGFyfSlgO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC+0LTQuNC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gICAgfSk7XHJcbiAgY2xvc2VNb2RhbChwb3B1cEF2YXRhcik7XHJcbiAgc2F2ZUF2YXRhckJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xyXG59XHJcbmZvcm1OZXdBdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKCkgPT4ge1xyXG4gIHNhdmVBdmF0YXJCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xyXG4gIGlzSW1hZ2VMaW5rKFxyXG4gICAgaGFuZGxlRm9ybU5ld0F2YXRhclN1Ym1pdCxcclxuICAgIGZvcm1OZXdBdmF0YXIsXHJcbiAgICBsaW5rQXZhdGFyLFxyXG4gICAgc2F2ZUF2YXRhckJ1dHRvblxyXG4gICk7XHJcbn0pO1xyXG5cclxuLy8g0YDQtdC00LDQutGC0LjRgNCy0L7QsNGC0Ywg0L/RgNC+0YTQuNC70YxcclxuXHJcbmNvbnN0IGZvcm1FZGl0ID0gZG9jdW1lbnQuZm9ybXNbJ2VkaXQtcHJvZmlsZSddO1xyXG5jb25zdCBuYW1lID0gZm9ybUVkaXQubmFtZTtcclxuY29uc3Qgam9iID0gZm9ybUVkaXQuZGVzY3JpcHRpb247XHJcbmNvbnN0IHNhdmVVc2VySW5mb0J1dHRvbiA9IGZvcm1FZGl0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVGb3JtRWRpdFN1Ym1pdChldnQpIHtcclxuICB1cGRhdGVVc2VySW5mbyhuYW1lLnZhbHVlLCBqb2IudmFsdWUpXHJcbiAgICAudGhlbigodXNlcikgPT4ge1xyXG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXIubmFtZTtcclxuICAgICAgcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IHVzZXIuYWJvdXQ7XHJcbiAgICAgIGNsb3NlTW9kYWwocG9wdXBQcm9maWxlRWRpdCk7XHJcbiAgICAgIHNhdmVVc2VySW5mb0J1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC+0LTQuNC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gICAgfSk7XHJcbn1cclxuZm9ybUVkaXQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKCkgPT4ge1xyXG4gIHNhdmVVc2VySW5mb0J1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLic7XHJcbiAgaGFuZGxlRm9ybUVkaXRTdWJtaXQoKTtcclxufSk7XHJcblxyXG4vLyDQvdC+0LLQvtC1INC80LXRgdGC0L5cclxuXHJcbmNvbnN0IGZvcm1OZXdQbGFjZSA9IGRvY3VtZW50LmZvcm1zWyduZXctcGxhY2UnXTtcclxuY29uc3QgbmFtZVBsYWNlID0gZm9ybU5ld1BsYWNlWydwbGFjZS1uYW1lJ107XHJcbmNvbnN0IGxpbmtQbGFjZSA9IGZvcm1OZXdQbGFjZVsnbGluayddO1xyXG5jb25zdCBzYXZlUGxhY2VCdXR0b24gPSBmb3JtTmV3UGxhY2UucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUZvcm1OZXdQbGFjZVN1Ym1pdChldnQpIHtcclxuICBhZGROZXdDYXJkUmVxdWVzdChuYW1lUGxhY2UudmFsdWUsIGxpbmtQbGFjZS52YWx1ZSlcclxuICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBuZXdDYXJkID0gY3JhZXRlQ2FyZChcclxuICAgICAgICBjYXJkRGF0YSxcclxuICAgICAgICBteVVzZXJJZCxcclxuICAgICAgICBoYW5kbGVMaWtlQ2FyZCxcclxuICAgICAgICBoYW5kbGVEZWxldGVDYXJkLFxyXG4gICAgICAgIG9wZW5JbWdQb3B1cFxyXG4gICAgICApO1xyXG4gICAgICBwbGFjZXNMaXN0LnByZXBlbmQobmV3Q2FyZCk7XHJcbiAgICAgIGNsb3NlTW9kYWwocG9wdXBOZXdDYXJkKTtcclxuICAgICAgc2F2ZVBsYWNlQnV0dG9uLnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC40YLRjCc7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTsgLy8g0LLRi9Cy0L7QtNC40Lwg0L7RiNC40LHQutGDINCyINC60L7QvdGB0L7Qu9GMXHJcbiAgICB9KTtcclxufVxyXG5cclxuZm9ybU5ld1BsYWNlLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsICgpID0+IHtcclxuICBzYXZlUGxhY2VCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xyXG4gIGlzSW1hZ2VMaW5rKFxyXG4gICAgaGFuZGxlRm9ybU5ld1BsYWNlU3VibWl0LFxyXG4gICAgZm9ybU5ld1BsYWNlLFxyXG4gICAgbGlua1BsYWNlLFxyXG4gICAgc2F2ZVBsYWNlQnV0dG9uXHJcbiAgKTtcclxufSk7XHJcblxyXG4vLyDRg9C00LDQu9C10L3QuNC1INC60LDRgNGC0L7Rh9C60LhcclxuXHJcbmNvbnN0IGZvcm1EZWxldGVDYXJkID0gZG9jdW1lbnQuZm9ybXNbJ2RlbGV0ZS1jYXJkJ107XHJcbmNvbnN0IGNvbmZpcm1EZWxldGVCdXR0b24gPSBmb3JtRGVsZXRlQ2FyZC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkKSB7XHJcbiAgcmVtb3ZlQ2FyZChjYXJkLmlkKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBkZWxldGVDYXJkKGNhcmQuY2FyZCk7XHJcbiAgICAgIGNsb3NlTW9kYWwocG9wdXBEZWxldGUpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC+0LTQuNC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZvcm1EZWxldGVDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsICgpID0+IHtcclxuICBoYW5kbGVEZWxldGVDYXJkKGNhcmRUb0RlbGV0ZSk7XHJcbn0pO1xyXG5cclxuLy8gLS3QktCw0LvQuNC00LDRhtC40Y8g0YTQvtGA0LwtLVxyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcclxuXHJcbi8vIC0tQVBJLS1cclxuXHJcblByb21pc2UuYWxsKFtnZXRVc2VySW5mbygpLCBnZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgY29uc3QgdXNlciA9IHJlc3VsdFswXTtcclxuICAgIGNvbnN0IGNhcmRzID0gcmVzdWx0WzFdO1xyXG4gICAgLy8g0L7QsdGA0LDQsdCw0YLRi9Cy0LDQtdC8INGA0LXQt9GD0LvRjNGC0LDRglxyXG4gICAgKHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlci5uYW1lKSxcclxuICAgICAgKHByb2ZpbGVKb2IudGV4dENvbnRlbnQgPSB1c2VyLmFib3V0KSxcclxuICAgICAgKGF2YXRhckltZy5zdHlsZSA9IGBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJHt1c2VyLmF2YXRhcn0pYCksXHJcbiAgICAgIChteVVzZXJJZCA9IHVzZXIuX2lkKTtcclxuICAgIHNob3dDYXJkcyhjYXJkcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTsgLy8g0LLRi9Cy0L7QtNC40Lwg0L7RiNC40LHQutGDINCyINC60L7QvdGB0L7Qu9GMXHJcbiAgfSk7XHJcblxyXG5mdW5jdGlvbiBzaG93Q2FyZHMoY2FyZHMpIHtcclxuICBjYXJkcy5mb3JFYWNoKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmFldGVDYXJkKFxyXG4gICAgICBjYXJkRGF0YSxcclxuICAgICAgbXlVc2VySWQsXHJcbiAgICAgIGhhbmRsZUxpa2VDYXJkLFxyXG4gICAgICBoYW5kbGVEZWxldGVDYXJkLFxyXG4gICAgICBvcGVuSW1nUG9wdXBcclxuICAgICk7XHJcbiAgICBwbGFjZXNMaXN0LmFwcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgfSk7XHJcbn1cclxuIl0sIm5hbWVzIjpbImN1cnJlbnRQb3B1cCIsIm9wZW5Nb2RhbCIsInBvcHVwIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsaWNrSGFuZGxlciIsIndpbmRvdyIsImtleUhhbmRsZXIiLCJldnQiLCJ0YXJnZXQiLCJjbG9zZU1vZGFsIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsImNhcmRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJwb3B1cERlbGV0ZSIsImNhcmRUb0RlbGV0ZSIsImNyYWV0ZUNhcmQiLCJjYXJkRGF0YSIsInVzZXJJZCIsImhhbmRsZUxpa2VDYXJkIiwiaGFuZGxlRGVsZXRlQ2FyZCIsIm9wZW5JbWdQb3B1cCIsImNhcmRFbGVtZW50IiwiY2xvbmVOb2RlIiwiZGVsZXRlQnV0dG9uIiwibGlrZUJ1dHRvbiIsImxpa2VDb3VudGVyIiwiY2FyZEltYWdlIiwiY2FyZFRpdGxlIiwic3JjIiwibGluayIsImFsdCIsIm5hbWUiLCJ0ZXh0Q29udGVudCIsImxpa2VzIiwibGVuZ3RoIiwib3duZXIiLCJfaWQiLCJjYXJkIiwiaWQiLCJzb21lIiwibGlrZXIiLCJjb250YWlucyIsInRvZ2dsZUlzTGlrZWQiLCJjaGFuZ2VMaWtlIiwidXBkYXRlZENhcmQiLCJ0b2dnbGUiLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJzaG93SW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiY29uY2F0IiwiaGlkZUlucHV0RXJyb3IiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJjbGVhclZhbGlkYXRpb24iLCJmb3JtIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpc0ltYWdlTGluayIsImhhbmRsZUZ1bmN0aW9uIiwiZmV0Y2giLCJ2YWx1ZSIsInRoZW4iLCJyZXMiLCJvayIsImhlYWRlcnMiLCJnZXQiLCJpbmNsdWRlcyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsIm15VXNlcklkIiwiY29uZmlnIiwiYmFzZVVybCIsImF1dGhvcml6YXRpb24iLCJjaGVja1Jlc3BvbnNlIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJhZGRMaWtlUmVxdWVzdCIsImNhcmRJZCIsIm1ldGhvZCIsInJlbW92ZUxpa2VSZXF1ZXN0IiwicGxhY2VzTGlzdCIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJjbG9zZUJ1dHRvbnMiLCJwb3B1cHMiLCJwb3B1cEF2YXRhciIsInBvcHVwUHJvZmlsZUVkaXQiLCJwb3B1cE5ld0NhcmQiLCJwb3B1cEltYWdlIiwic2NhbGVkSW1nIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlSm9iIiwiYXZhdGFySW1nIiwiZm9ybU5ld0F2YXRhciIsInJlc2V0Iiwiam9iIiwiZm9ybU5ld1BsYWNlIiwiYnV0dG9uIiwiY2xvc2VzdCIsImZvcm1zIiwibGlua0F2YXRhciIsInNhdmVBdmF0YXJCdXR0b24iLCJoYW5kbGVGb3JtTmV3QXZhdGFyU3VibWl0IiwidXNlckF2YXRhciIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXZhdGFyIiwidXNlciIsInN0eWxlIiwiZm9ybUVkaXQiLCJkZXNjcmlwdGlvbiIsInNhdmVVc2VySW5mb0J1dHRvbiIsInVzZXJOYW1lIiwidXNlckFib3V0IiwiYWJvdXQiLCJuYW1lUGxhY2UiLCJsaW5rUGxhY2UiLCJzYXZlUGxhY2VCdXR0b24iLCJoYW5kbGVGb3JtTmV3UGxhY2VTdWJtaXQiLCJjYXJkTmFtZSIsImNhcmRMaW5rIiwibmV3Q2FyZCIsInByZXBlbmQiLCJmb3JtRGVsZXRlQ2FyZCIsImRlbGV0ZUNhcmQiLCJwcmV2ZW50RGVmYXVsdCIsInBhdHRlcm5NaXNtYXRjaCIsInNldEN1c3RvbVZhbGlkaXR5IiwiZGF0YXNldCIsInZhbGlkYXRpb25NZXNzYWdlIiwiaXNWYWxpZCIsInNldEV2ZW50TGlzdGVuZXJzIiwiYWxsIiwicmVzdWx0IiwiY2FyZHMiLCJhcHBlbmQiLCJzaG93Q2FyZHMiXSwic291cmNlUm9vdCI6IiJ9