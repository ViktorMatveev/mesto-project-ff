(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/wff-cohort-7",headers:{authorization:"a6b69f63-2d28-4d22-b690-1e15b17804c6","Content-Type":"application/json"}},t=function(t){return fetch("".concat(e.baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))},n=function(t){return fetch("".concat(e.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))},o=function(t){return fetch("".concat(e.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))},r=document.querySelector(".places__list"),c=document.querySelector("#card-template").content;function a(e,t,n,o,r){var a=c.querySelector(".card").cloneNode(!0);return a.querySelector(".card__image").src=e.link,a.querySelector(".card__image").alt=e.name,a.querySelector(".card__title").textContent=e.name,a.querySelector(".card__like-counter").textContent=e.likes.length,t!==e.owner._id?a.querySelector(".card__delete-button").remove():a.querySelector(".card__delete-button").addEventListener("click",(function(t){o(e).then((function(){t.target.closest(".card").remove()})).catch((function(e){console.log(e)}))})),e.likes.some((function(e){return e._id===t}))?a.querySelector(".card__like-button").classList.add("card__like-button_is-active"):a.querySelector(".card__like-button").classList.remove("card__like-button_is-active"),a.querySelector(".card__like-button").addEventListener("click",(function(t){n(e,a).then((function(e){a.querySelector(".card__like-counter").textContent=e.likes.length,t.target.classList.toggle("card__like-button_is-active")})).catch((function(e){console.log(e)}))})),a.addEventListener("click",r),a}function u(e,o){return o.querySelector(".card__like-button").classList.contains("card__like-button_is-active")?n(e._id):t(e._id)}function i(e){return o(e._id)}var s=null;function l(e){return e.classList.add("popup_is-opened"),s=e,e.addEventListener("click",d),window.addEventListener("keydown",f),s}function d(e){e.target===s&&p(s)}function p(e){e.classList.remove("popup_is-opened"),window.removeEventListener("keydown",f)}function f(e){"Escape"===e.key&&p(s)}var _,m={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function v(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(m.inputErrorClass),o.textContent=n,o.classList.add(m.errorClass)}function y(e,t){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(m.inputErrorClass),n.classList.remove(m.errorClass),n.textContent=""}function h(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(m.inactiveButtonClass)):(t.disabled=!0,t.classList.add(m.inactiveButtonClass))}function S(e){var t=Array.from(e.querySelectorAll(m.inputSelector));t.forEach((function(t){y(e,t)})),h(t,e.querySelector(m.submitButtonSelector))}function b(e,t,n,o){fetch(n.value).then((function(r){r.ok&&r.headers.get("Content-Type").includes("image")?e():(v(t,n,"URL не передает изображение"),o.disabled=!0,o.classList.add(m.inactiveButtonClass),o.textContent="Сохранить")})).catch((function(e){console.log("Oшибка запроса",e)}))}var k=document.querySelector(".profile__edit-button"),q=document.querySelector(".profile__add-button"),g=Array.from(document.querySelectorAll(".popup__close")),C=Array.from(document.querySelectorAll(".popup")),L=document.querySelector(".popup_type_avatar"),E=document.querySelector(".popup_type_edit"),x=document.querySelector(".popup_type_new-card"),j=document.querySelector(".popup_type_image"),P=document.querySelector(".profile__title"),A=document.querySelector(".profile__description"),U=document.querySelector(".profile__image");function w(e){if(e.target.classList.contains("card__image")){l(j);var t=j.querySelector(".popup__image");t.src=e.target.src,t.alt=e.target.alt,j.querySelector(".popup__caption").textContent=e.target.alt}}C.forEach((function(e){return e.classList.add("popup_is-animated")})),U.addEventListener("click",(function(){T.reset(),S(L.querySelector(".popup__form")),l(L)})),k.addEventListener("click",(function(){J.value=P.textContent,M.value=A.textContent,S(E.querySelector(".popup__form")),l(E)})),q.addEventListener("click",(function(){V.reset(),S(x.querySelector(".popup__form")),l(x)})),g.forEach((function(e){return e.addEventListener("click",(function(){p(e.closest(".popup"))}))}));var T=document.forms["edit-avatar"],B=T.avatar,O=T.querySelector(".popup__button");function N(t){var n;(n=B.value,fetch("".concat(e.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){U.style="background-image: url(".concat(e.avatar,")")})).catch((function(e){console.log(e)})),p(L),O.textContent="Сохранить"}T.addEventListener("submit",(function(){O.textContent="Сохранение...",b(N,T,B,O)}));var D=document.forms["edit-profile"],J=D.name,M=D.description,H=D.querySelector(".popup__button");D.addEventListener("submit",(function(){var t,n;H.textContent="Сохранение...",console.log(H.textContent),(t=J.value,n=M.value,fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){P.textContent=e.name,A.textContent=e.about,p(E),H.textContent="Сохранить"})).catch((function(e){console.log(e)}))}));var V=document.forms["new-place"],z=V["place-name"],R=V.link,F=V.querySelector(".popup__button");function G(t){var n,o;(n=z.value,o=R.value,fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify({name:n,link:o})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){var t=a(e,_,u,i,w);r.prepend(t),p(x),F.textContent="Сохранить"})).catch((function(e){console.log(e)}))}V.addEventListener("submit",(function(){F.textContent="Сохранение...",b(G,V,R,F)})),Array.from(document.querySelectorAll(m.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(m.inputSelector)),n=e.querySelector(m.submitButtonSelector);h(t,n),t.forEach((function(o){o.addEventListener("input",(function(){!function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?y(e,t):v(e,t,t.validationMessage)}(e,o),h(t,n)}))}))}(e)})),Promise.all([fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})),fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))]).then((function(e){var t=e[0],n=e[1];P.textContent=t.name,A.textContent=t.about,U.style="background-image: url(".concat(t.avatar,")"),_=t._id,function(e){e.forEach((function(e){var t=a(e,_,u,i,w);r.append(t)}))}(n)})).catch((function(e){console.log(e)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFDQXZDLEVBQ0FDLEVBQ0FDLEdBRUZWLEVBQVdvSSxPQUFPekgsRUFDcEIsR0FDRixDQWpCSTBILENBQVVGLEVBQ1osSUFDQ3hHLE9BQU0sU0FBQ0MsR0FDTkMsUUFBUUMsSUFBSUYsRUFDZCxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC8uL3NyYy9zY3JpcHRzL2Nvbm1wb25lbnRzL2FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0Ly4vc3JjL3NjcmlwdHMvY29ubXBvbmVudHMvY2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0Ly4vc3JjL3NjcmlwdHMvY29ubXBvbmVudHMvbW9kYWwuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC8uL3NyYy9zY3JpcHRzL2Nvbm1wb25lbnRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC8uL3NyYy9zY3JpcHRzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIC0t0YDQsNCx0L7RgtCwINGBIEFQSS0tXHJcblxyXG4vLyDQotC+0LrQtdC9OiBhNmI2OWY2My0yZDI4LTRkMjItYjY5MC0xZTE1YjE3ODA0YzZcclxuLy8g0JjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0LPRgNGD0L/Qv9GLOiB3ZmYtY29ob3J0LTdcclxuXHJcbmNvbnN0IGNvbmZpZyA9IHtcclxuICBiYXNlVXJsOiAnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtNycsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogJ2E2YjY5ZjYzLTJkMjgtNGQyMi1iNjkwLTFlMTViMTc4MDRjNicsXHJcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gIH0sXHJcbn07XHJcblxyXG4vLyDQt9Cw0L/RgNC+0YEg0L3QsCDQv9C+0LvRg9GH0LXQvdC40LUg0LrQsNGA0YLQvtGH0LXQulxyXG5cclxuY29uc3QgZ2V0SW5pdGlhbENhcmRzID0gKCkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICAvLyDQtdGB0LvQuCDQvtGI0LjQsdC60LAsINC+0YLQutC70L7QvdGP0LXQvCDQv9GA0L7QvNC40YFcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vLyDQt9Cw0L/RgNC+0YEg0L3QsCDQuNC90YTQviDQviDQv9C+0LvRjNC30L7QstCw0YLQtdC70LVcclxuXHJcbmNvbnN0IGdldFVzZXJJbmZvID0gKCkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICAvLyDQtdGB0LvQuCDQvtGI0LjQsdC60LAsINC+0YLQutC70L7QvdGP0LXQvCDQv9GA0L7QvNC40YFcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vLyDQt9Cw0L/RgNC+0YEg0L3QsCDQuNC30LzQtdC90LXQvdC40LUg0LjQvdGE0L7RgNC80LDRhtC40Lgg0L4g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9C1XHJcblxyXG5jb25zdCB1cGRhdGVVc2VySW5mbyA9ICh1c2VyTmFtZSwgdXNlckFib3V0KSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lOiB1c2VyTmFtZSwgYWJvdXQ6IHVzZXJBYm91dCB9KSxcclxuICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICAvLyDQtdGB0LvQuCDQvtGI0LjQsdC60LAsINC+0YLQutC70L7QvdGP0LXQvCDQv9GA0L7QvNC40YFcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vLyDQt9Cw0L/RgNC+0YEg0L3QsCDQuNC30LzQtdC90LXQvdC40LUg0LDQstCw0YLQsNGA0LAg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXHJcblxyXG5jb25zdCB1cGRhdGVVc2VyQXZhdGFyID0gKHVzZXJBdmF0YXIpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IHVzZXJBdmF0YXIgfSksXHJcbiAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgLy8g0LXRgdC70Lgg0L7RiNC40LHQutCwLCDQvtGC0LrQu9C+0L3Rj9C10Lwg0L/RgNC+0LzQuNGBXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLy8g0LfQsNC/0YDQvtGBINC90LAg0LTQvtCx0LDQstC70LXQvdC40LUg0LrQsNGA0YLQvtGH0LrQuCDQvdCwINGB0LXRgNCy0LXRgFxyXG5cclxuY29uc3QgYWRkTmV3Q2FyZFJlcXVlc3QgPSAoY2FyZE5hbWUsIGNhcmRMaW5rKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWU6IGNhcmROYW1lLCBsaW5rOiBjYXJkTGluayB9KSxcclxuICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICAvLyDQtdGB0LvQuCDQvtGI0LjQsdC60LAsINC+0YLQutC70L7QvdGP0LXQvCDQv9GA0L7QvNC40YFcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vLyDQt9Cw0L/RgNC+0YEg0L3QsCDQtNC+0LHQsNC70LXQvdC40LUg0LvQsNC50LrQsFxyXG5cclxuY29uc3QgYWRkTGlrZVJlcXVlc3QgPSAoY2FyZElkKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgLy8g0LXRgdC70Lgg0L7RiNC40LHQutCwLCDQvtGC0LrQu9C+0L3Rj9C10Lwg0L/RgNC+0LzQuNGBXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLy8g0LfQsNC/0YDQvtGBINC90LAg0YHQvdGP0YLQuNC1INC70LDQudC60LBcclxuXHJcbmNvbnN0IHJlbW92ZUxpa2VSZXF1ZXN0ID0gKGNhcmRJZCkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIC8vINC10YHQu9C4INC+0YjQuNCx0LrQsCwg0L7RgtC60LvQvtC90Y/QtdC8INC/0YDQvtC80LjRgVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9KTtcclxufTtcclxuXHJcbi8vINC30LDQv9GA0L7RgSDQvdCwINGD0LTQsNC70LXQvdC40LUg0LrQsNGA0YLQvtGH0LrQuFxyXG5cclxuY29uc3QgcmVtb3ZlQ2FyZCA9IChjYXJkSWQpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICAvLyDQtdGB0LvQuCDQvtGI0LjQsdC60LAsINC+0YLQutC70L7QvdGP0LXQvCDQv9GA0L7QvNC40YFcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQge1xyXG4gIGdldEluaXRpYWxDYXJkcyxcclxuICBnZXRVc2VySW5mbyxcclxuICB1cGRhdGVVc2VySW5mbyxcclxuICB1cGRhdGVVc2VyQXZhdGFyLFxyXG4gIGFkZE5ld0NhcmRSZXF1ZXN0LFxyXG4gIGFkZExpa2VSZXF1ZXN0LFxyXG4gIHJlbW92ZUxpa2VSZXF1ZXN0LFxyXG4gIHJlbW92ZUNhcmQsXHJcbn07XHJcbiIsImltcG9ydCB7IGFkZExpa2VSZXF1ZXN0LCByZW1vdmVMaWtlUmVxdWVzdCwgcmVtb3ZlQ2FyZCB9IGZyb20gJy4vYXBpJztcclxuXHJcbmNvbnN0IHBsYWNlc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19saXN0Jyk7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYXJkLXRlbXBsYXRlJykuY29udGVudDtcclxuXHJcbmZ1bmN0aW9uIGNyYWV0ZUNhcmQoY2FyZCwgdXNlcklkLCB0b2dnbGVJc0xpa2VkLCBkZWxldGVDYXJkLCBvcGVuSW1nUG9wdXApIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpLmNsb25lTm9kZSh0cnVlKTtcclxuICBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKS5zcmMgPSBjYXJkLmxpbms7XHJcbiAgY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJykuYWx0ID0gY2FyZC5uYW1lO1xyXG4gIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpLnRleHRDb250ZW50ID0gY2FyZC5uYW1lO1xyXG4gIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50ZXInKS50ZXh0Q29udGVudCA9XHJcbiAgICBjYXJkLmxpa2VzLmxlbmd0aDtcclxuXHJcbiAgLy8g0YPQtNCw0LvRj9C10Lwg0LrQsNGA0LfQuNC90LrRgyDRgSDRh9GD0LbQvtC5INC60LDRgNGC0L7Rh9C60LhcclxuICBpZiAodXNlcklkICE9PSBjYXJkLm93bmVyLl9pZCkge1xyXG4gICAgY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKS5yZW1vdmUoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJylcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICAgIGRlbGV0ZUNhcmQoY2FyZClcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnRhcmdldC5jbG9zZXN0KCcuY2FyZCcpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC+0LTQuNC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8g0L/RgNC+0LLQtdGA0LrQsCDQu9Cw0LnQutCwINC/0YDQuCDQt9Cw0LPRgNGD0LfQutC1XHJcbiAgaWYgKGNhcmQubGlrZXMuc29tZSgobGlrZXIpID0+IGxpa2VyLl9pZCA9PT0gdXNlcklkKSkge1xyXG4gICAgY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpXHJcbiAgICAgIC5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpXHJcbiAgICAgIC5jbGFzc0xpc3QucmVtb3ZlKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICB9XHJcblxyXG4gIGNhcmRFbGVtZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJylcclxuICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgdG9nZ2xlSXNMaWtlZChjYXJkLCBjYXJkRWxlbWVudClcclxuICAgICAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgICAgIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50ZXInKS50ZXh0Q29udGVudCA9XHJcbiAgICAgICAgICAgIHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aDtcclxuICAgICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coZXJyKTsgLy8g0LLRi9Cy0L7QtNC40Lwg0L7RiNC40LHQutGDINCyINC60L7QvdGB0L7Qu9GMXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgY2FyZEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuSW1nUG9wdXApO1xyXG5cclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvZ2dsZUlzTGlrZWQoY2FyZCwgY2FyZEVsZW1lbnQpIHtcclxuICBpZiAoXHJcbiAgICBjYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJylcclxuICAgICAgLmNsYXNzTGlzdC5jb250YWlucygnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJylcclxuICApIHtcclxuICAgIHJldHVybiByZW1vdmVMaWtlUmVxdWVzdChjYXJkLl9pZCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiBhZGRMaWtlUmVxdWVzdChjYXJkLl9pZCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBkZWxldGVDYXJkKGNhcmQpIHtcclxuICByZXR1cm4gcmVtb3ZlQ2FyZChjYXJkLl9pZCk7XHJcbn1cclxuXHJcbmV4cG9ydCB7IHBsYWNlc0xpc3QsIGNhcmRUZW1wbGF0ZSwgY3JhZXRlQ2FyZCwgdG9nZ2xlSXNMaWtlZCwgZGVsZXRlQ2FyZCB9O1xyXG4iLCJsZXQgY3VycmVudFBvcHVwID0gbnVsbDtcclxuZnVuY3Rpb24gb3Blbk1vZGFsKHBvcHVwKSB7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfaXMtb3BlbmVkJyk7XHJcbiAgY3VycmVudFBvcHVwID0gcG9wdXA7XHJcbiAgcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGlja0hhbmRsZXIpO1xyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5SGFuZGxlcik7XHJcbiAgcmV0dXJuIGN1cnJlbnRQb3B1cDtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xpY2tIYW5kbGVyKGV2dCkge1xyXG4gIGlmIChldnQudGFyZ2V0ID09PSBjdXJyZW50UG9wdXApIHtcclxuICAgIGNsb3NlTW9kYWwoY3VycmVudFBvcHVwKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwocG9wdXApIHtcclxuICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9pcy1vcGVuZWQnKTtcclxuICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleUhhbmRsZXIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBrZXlIYW5kbGVyKGV2dCkge1xyXG4gIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xyXG4gICAgY2xvc2VNb2RhbChjdXJyZW50UG9wdXApO1xyXG4gIH1cclxufVxyXG5leHBvcnQgeyBvcGVuTW9kYWwsIGNsb3NlTW9kYWwgfTtcclxuIiwiY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxyXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fYnV0dG9uJyxcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZScsXHJcbn07XHJcblxyXG5mdW5jdGlvbiBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh2YWxpZGF0aW9uQ29uZmlnLmVycm9yQ2xhc3MpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KSB7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHZhbGlkYXRpb25Db25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1ZhbGlkKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQpIHtcclxuICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnBhdHRlcm5NaXNtYXRjaCkge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yTWVzc2FnZSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGlucHV0RWxlbWVudC5zZXRDdXN0b21WYWxpZGl0eSgnJyk7XHJcbiAgfVxyXG5cclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCkge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuaW5wdXRTZWxlY3RvcilcclxuICApO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgdmFsaWRhdGlvbkNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICk7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGlzVmFsaWQoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuZm9ybVNlbGVjdG9yKVxyXG4gICk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50KTtcclxuICB9KTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCkge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHZhbGlkYXRpb25Db25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhclZhbGlkYXRpb24oZm9ybSkge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvbkNvbmZpZy5pbnB1dFNlbGVjdG9yKVxyXG4gICk7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybSwgaW5wdXRFbGVtZW50KTtcclxuICB9KTtcclxuICBjb25zdCBmb3JtQnV0dG9uID0gZm9ybS5xdWVyeVNlbGVjdG9yKHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgZm9ybUJ1dHRvbik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzSW1hZ2VMaW5rKGhhbmRsZUZ1bmN0aW9uLCBmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBidXR0b25FbGVtZW50KSB7XHJcbiAgZmV0Y2goaW5wdXRFbGVtZW50LnZhbHVlKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rICYmIHJlcy5oZWFkZXJzLmdldCgnQ29udGVudC1UeXBlJykuaW5jbHVkZXMoJ2ltYWdlJykpIHtcclxuICAgICAgICBoYW5kbGVGdW5jdGlvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9ICdVUkwg0L3QtSDQv9C10YDQtdC00LDQtdGCINC40LfQvtCx0YDQsNC20LXQvdC40LUnO1xyXG4gICAgICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSk7XHJcbiAgICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHZhbGlkYXRpb25Db25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coJ0/RiNC40LHQutCwINC30LDQv9GA0L7RgdCwJywgZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgeyBlbmFibGVWYWxpZGF0aW9uLCBjbGVhclZhbGlkYXRpb24sIHZhbGlkYXRpb25Db25maWcsIGlzSW1hZ2VMaW5rIH07XHJcbiIsImltcG9ydCAnLi4vcGFnZXMvaW5kZXguY3NzJztcclxuXHJcbmltcG9ydCB7XHJcbiAgcGxhY2VzTGlzdCxcclxuICBjcmFldGVDYXJkLFxyXG4gIHRvZ2dsZUlzTGlrZWQsXHJcbiAgZGVsZXRlQ2FyZCxcclxufSBmcm9tICcuL2Nvbm1wb25lbnRzL2NhcmQnO1xyXG5cclxuaW1wb3J0IHsgb3Blbk1vZGFsLCBjbG9zZU1vZGFsIH0gZnJvbSAnLi9jb25tcG9uZW50cy9tb2RhbCc7XHJcblxyXG5pbXBvcnQge1xyXG4gIGVuYWJsZVZhbGlkYXRpb24sXHJcbiAgY2xlYXJWYWxpZGF0aW9uLFxyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgaXNJbWFnZUxpbmssXHJcbn0gZnJvbSAnLi9jb25tcG9uZW50cy92YWxpZGF0aW9uJztcclxuXHJcbmltcG9ydCB7XHJcbiAgZ2V0SW5pdGlhbENhcmRzLFxyXG4gIGdldFVzZXJJbmZvLFxyXG4gIHVwZGF0ZVVzZXJJbmZvLFxyXG4gIHVwZGF0ZVVzZXJBdmF0YXIsXHJcbiAgYWRkTmV3Q2FyZFJlcXVlc3QsXHJcbn0gZnJvbSAnLi9jb25tcG9uZW50cy9hcGknO1xyXG4vLyAtYnV0dG9ucy1cclxuXHJcbmxldCBteVVzZXJJZDtcclxuXHJcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuY29uc3QgY2xvc2VCdXR0b25zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2Nsb3NlJykpO1xyXG5cclxuLy8gLXBvcHVwcy1cclxuXHJcbmNvbnN0IHBvcHVwcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwJykpO1xyXG5jb25zdCBwb3B1cEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2F2YXRhcicpO1xyXG5jb25zdCBwb3B1cFByb2ZpbGVFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdCcpO1xyXG5jb25zdCBwb3B1cE5ld0NhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9uZXctY2FyZCcpO1xyXG5jb25zdCBwb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfaW1hZ2UnKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJyk7XHJcbmNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZGVzY3JpcHRpb24nKTtcclxuY29uc3QgYXZhdGFySW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XHJcblxyXG5wb3B1cHMuZm9yRWFjaCgocG9wdXApID0+IHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX2lzLWFuaW1hdGVkJykpO1xyXG5cclxuLy8gLS3QstGL0LfQvtCyINC4INC30LDRgNGL0YLQuNC1INC80L7QtNCw0LvRjNC90YvRhSDQvtC60L7QvS0tXHJcbi8vINCw0LLQsNGC0LDRgFxyXG5hdmF0YXJJbWcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgZm9ybU5ld0F2YXRhci5yZXNldCgpLFxyXG4gICAgY2xlYXJWYWxpZGF0aW9uKHBvcHVwQXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpKSxcclxuICAgIG9wZW5Nb2RhbChwb3B1cEF2YXRhcik7XHJcbn0pO1xyXG5cclxuLy8g0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjQtSDQv9GA0L7RhNC40LvRj1xyXG5cclxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBuYW1lLnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgam9iLnZhbHVlID0gcHJvZmlsZUpvYi50ZXh0Q29udGVudDtcclxuICBjbGVhclZhbGlkYXRpb24ocG9wdXBQcm9maWxlRWRpdC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKSksXHJcbiAgICBvcGVuTW9kYWwocG9wdXBQcm9maWxlRWRpdCk7XHJcbn0pO1xyXG5cclxuLy8g0L3QvtCy0L7QtSDQvNC10YHRgtC+XHJcblxyXG5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgZm9ybU5ld1BsYWNlLnJlc2V0KCksXHJcbiAgICBjbGVhclZhbGlkYXRpb24ocG9wdXBOZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpKSxcclxuICAgIG9wZW5Nb2RhbChwb3B1cE5ld0NhcmQpO1xyXG59KTtcclxuXHJcbi8vINC30LDQutGA0YvRgtGMXHJcblxyXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PlxyXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIGNsb3NlTW9kYWwoYnV0dG9uLmNsb3Nlc3QoJy5wb3B1cCcpKTtcclxuICB9KVxyXG4pO1xyXG5cclxuLy8g0L/QvtC/0LDQvyDRgSDQutCw0YDRgtC40L3QutC+0LlcclxuXHJcbmZ1bmN0aW9uIG9wZW5JbWdQb3B1cChldnQpIHtcclxuICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NhcmRfX2ltYWdlJykpIHtcclxuICAgIG9wZW5Nb2RhbChwb3B1cEltYWdlKTtcclxuICAgIGNvbnN0IHNjYWxlZEltZyA9IHBvcHVwSW1hZ2UucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xyXG4gICAgc2NhbGVkSW1nLnNyYyA9IGV2dC50YXJnZXQuc3JjO1xyXG4gICAgc2NhbGVkSW1nLmFsdCA9IGV2dC50YXJnZXQuYWx0O1xyXG4gICAgY29uc3QgY2FyZFRpdGxlID0gcG9wdXBJbWFnZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKTtcclxuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGV2dC50YXJnZXQuYWx0O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS3QoNCw0LHQvtGC0LAg0YEg0YTQvtGA0LzQsNC80LgtLVxyXG5cclxuLy8g0YHQvNC10L3QuNGC0Ywg0LDQstCw0YLQsNGAXHJcblxyXG5jb25zdCBmb3JtTmV3QXZhdGFyID0gZG9jdW1lbnQuZm9ybXNbJ2VkaXQtYXZhdGFyJ107XHJcbmNvbnN0IGxpbmtBdmF0YXIgPSBmb3JtTmV3QXZhdGFyWydhdmF0YXInXTtcclxuY29uc3Qgc2F2ZUF2YXRhckJ1dHRvbiA9IGZvcm1OZXdBdmF0YXIucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUZvcm1OZXdBdmF0YXJTdWJtaXQoZXZ0KSB7XHJcbiAgdXBkYXRlVXNlckF2YXRhcihsaW5rQXZhdGFyLnZhbHVlKVxyXG4gICAgLnRoZW4oKHVzZXIpID0+IHtcclxuICAgICAgYXZhdGFySW1nLnN0eWxlID0gYGJhY2tncm91bmQtaW1hZ2U6IHVybCgke3VzZXIuYXZhdGFyfSlgO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC+0LTQuNC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gICAgfSk7XHJcbiAgY2xvc2VNb2RhbChwb3B1cEF2YXRhcik7XHJcbiAgc2F2ZUF2YXRhckJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xyXG59XHJcbmZvcm1OZXdBdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKCkgPT4ge1xyXG4gIHNhdmVBdmF0YXJCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xyXG4gIGlzSW1hZ2VMaW5rKFxyXG4gICAgaGFuZGxlRm9ybU5ld0F2YXRhclN1Ym1pdCxcclxuICAgIGZvcm1OZXdBdmF0YXIsXHJcbiAgICBsaW5rQXZhdGFyLFxyXG4gICAgc2F2ZUF2YXRhckJ1dHRvblxyXG4gICk7XHJcbn0pO1xyXG5cclxuLy8g0YDQtdC00LDQutGC0LjRgNCy0L7QsNGC0Ywg0L/RgNC+0YTQuNC70YxcclxuXHJcbmNvbnN0IGZvcm1FZGl0ID0gZG9jdW1lbnQuZm9ybXNbJ2VkaXQtcHJvZmlsZSddO1xyXG5jb25zdCBuYW1lID0gZm9ybUVkaXQubmFtZTtcclxuY29uc3Qgam9iID0gZm9ybUVkaXQuZGVzY3JpcHRpb247XHJcbmNvbnN0IHNhdmVVc2VySW5mb0J1dHRvbiA9IGZvcm1FZGl0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVGb3JtRWRpdFN1Ym1pdChldnQpIHtcclxuICBjb25zb2xlLmxvZyhzYXZlVXNlckluZm9CdXR0b24udGV4dENvbnRlbnQpO1xyXG4gIHVwZGF0ZVVzZXJJbmZvKG5hbWUudmFsdWUsIGpvYi52YWx1ZSlcclxuICAgIC50aGVuKCh1c2VyKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlci5uYW1lO1xyXG4gICAgICBwcm9maWxlSm9iLnRleHRDb250ZW50ID0gdXNlci5hYm91dDtcclxuICAgICAgY2xvc2VNb2RhbChwb3B1cFByb2ZpbGVFZGl0KTtcclxuICAgICAgc2F2ZVVzZXJJbmZvQnV0dG9uLnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC40YLRjCc7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTsgLy8g0LLRi9Cy0L7QtNC40Lwg0L7RiNC40LHQutGDINCyINC60L7QvdGB0L7Qu9GMXHJcbiAgICB9KTtcclxufVxyXG5mb3JtRWRpdC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoKSA9PiB7XHJcbiAgc2F2ZVVzZXJJbmZvQnV0dG9uLnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJztcclxuICBoYW5kbGVGb3JtRWRpdFN1Ym1pdCgpO1xyXG59KTtcclxuXHJcbi8vINC90L7QstC+0LUg0LzQtdGB0YLQvlxyXG5cclxuY29uc3QgZm9ybU5ld1BsYWNlID0gZG9jdW1lbnQuZm9ybXNbJ25ldy1wbGFjZSddO1xyXG5jb25zdCBuYW1lUGxhY2UgPSBmb3JtTmV3UGxhY2VbJ3BsYWNlLW5hbWUnXTtcclxuY29uc3QgbGlua1BsYWNlID0gZm9ybU5ld1BsYWNlWydsaW5rJ107XHJcbmNvbnN0IHNhdmVQbGFjZUJ1dHRvbiA9IGZvcm1OZXdQbGFjZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRm9ybU5ld1BsYWNlU3VibWl0KGV2dCkge1xyXG4gIGFkZE5ld0NhcmRSZXF1ZXN0KG5hbWVQbGFjZS52YWx1ZSwgbGlua1BsYWNlLnZhbHVlKVxyXG4gICAgLnRoZW4oKGNhcmQpID0+IHtcclxuICAgICAgY29uc3QgbmV3Q2FyZCA9IGNyYWV0ZUNhcmQoXHJcbiAgICAgICAgY2FyZCxcclxuICAgICAgICBteVVzZXJJZCxcclxuICAgICAgICB0b2dnbGVJc0xpa2VkLFxyXG4gICAgICAgIGRlbGV0ZUNhcmQsXHJcbiAgICAgICAgb3BlbkltZ1BvcHVwXHJcbiAgICAgICk7XHJcbiAgICAgIHBsYWNlc0xpc3QucHJlcGVuZChuZXdDYXJkKTtcclxuICAgICAgY2xvc2VNb2RhbChwb3B1cE5ld0NhcmQpO1xyXG4gICAgICBzYXZlUGxhY2VCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LjRgtGMJztcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpOyAvLyDQstGL0LLQvtC00LjQvCDQvtGI0LjQsdC60YMg0LIg0LrQvtC90YHQvtC70YxcclxuICAgIH0pO1xyXG59XHJcblxyXG5mb3JtTmV3UGxhY2UuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKCkgPT4ge1xyXG4gIHNhdmVQbGFjZUJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLic7XHJcbiAgaXNJbWFnZUxpbmsoXHJcbiAgICBoYW5kbGVGb3JtTmV3UGxhY2VTdWJtaXQsXHJcbiAgICBmb3JtTmV3UGxhY2UsXHJcbiAgICBsaW5rUGxhY2UsXHJcbiAgICBzYXZlUGxhY2VCdXR0b25cclxuICApO1xyXG59KTtcclxuXHJcbi8vIC0t0JLQsNC70LjQtNCw0YbQuNGPINGE0L7RgNC8LS1cclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7XHJcblxyXG4vLyAtLUFQSS0tXHJcblxyXG5Qcm9taXNlLmFsbChbZ2V0VXNlckluZm8oKSwgZ2V0SW5pdGlhbENhcmRzKCldKVxyXG4gIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgIGNvbnN0IHVzZXIgPSByZXN1bHRbMF07XHJcbiAgICBjb25zdCBjYXJkcyA9IHJlc3VsdFsxXTtcclxuICAgIC8vINC+0LHRgNCw0LHQsNGC0YvQstCw0LXQvCDRgNC10LfRg9C70YzRgtCw0YJcclxuICAgIChwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXIubmFtZSksXHJcbiAgICAgIChwcm9maWxlSm9iLnRleHRDb250ZW50ID0gdXNlci5hYm91dCksXHJcbiAgICAgIChhdmF0YXJJbWcuc3R5bGUgPSBgYmFja2dyb3VuZC1pbWFnZTogdXJsKCR7dXNlci5hdmF0YXJ9KWApLFxyXG4gICAgICAobXlVc2VySWQgPSB1c2VyLl9pZCk7XHJcbiAgICBzaG93Q2FyZHMoY2FyZHMpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC+0LTQuNC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gIH0pO1xyXG5cclxuZnVuY3Rpb24gc2hvd0NhcmRzKGNhcmRzKSB7XHJcbiAgY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmFldGVDYXJkKFxyXG4gICAgICBjYXJkLFxyXG4gICAgICBteVVzZXJJZCxcclxuICAgICAgdG9nZ2xlSXNMaWtlZCxcclxuICAgICAgZGVsZXRlQ2FyZCxcclxuICAgICAgb3BlbkltZ1BvcHVwXHJcbiAgICApO1xyXG4gICAgcGxhY2VzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vLyAtLUFQSS0tXHJcbiJdLCJuYW1lcyI6WyJjb25maWciLCJiYXNlVXJsIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJhZGRMaWtlUmVxdWVzdCIsImNhcmRJZCIsImZldGNoIiwiY29uY2F0IiwibWV0aG9kIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJyZW1vdmVMaWtlUmVxdWVzdCIsInJlbW92ZUNhcmQiLCJwbGFjZXNMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsImNyYWV0ZUNhcmQiLCJjYXJkIiwidXNlcklkIiwidG9nZ2xlSXNMaWtlZCIsImRlbGV0ZUNhcmQiLCJvcGVuSW1nUG9wdXAiLCJjYXJkRWxlbWVudCIsImNsb25lTm9kZSIsInNyYyIsImxpbmsiLCJhbHQiLCJuYW1lIiwidGV4dENvbnRlbnQiLCJsaWtlcyIsImxlbmd0aCIsIm93bmVyIiwiX2lkIiwicmVtb3ZlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsInRhcmdldCIsImNsb3Nlc3QiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJzb21lIiwibGlrZXIiLCJjbGFzc0xpc3QiLCJhZGQiLCJ1cGRhdGVkQ2FyZCIsInRvZ2dsZSIsImNvbnRhaW5zIiwiY3VycmVudFBvcHVwIiwib3Blbk1vZGFsIiwicG9wdXAiLCJjbGlja0hhbmRsZXIiLCJ3aW5kb3ciLCJrZXlIYW5kbGVyIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJteVVzZXJJZCIsInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInNob3dJbnB1dEVycm9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsImhpZGVJbnB1dEVycm9yIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiY2xlYXJWYWxpZGF0aW9uIiwiZm9ybSIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaXNJbWFnZUxpbmsiLCJoYW5kbGVGdW5jdGlvbiIsInZhbHVlIiwiZ2V0IiwiaW5jbHVkZXMiLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwiY2xvc2VCdXR0b25zIiwicG9wdXBzIiwicG9wdXBBdmF0YXIiLCJwb3B1cFByb2ZpbGVFZGl0IiwicG9wdXBOZXdDYXJkIiwicG9wdXBJbWFnZSIsInByb2ZpbGVOYW1lIiwicHJvZmlsZUpvYiIsImF2YXRhckltZyIsInNjYWxlZEltZyIsImZvcm1OZXdBdmF0YXIiLCJyZXNldCIsImpvYiIsImZvcm1OZXdQbGFjZSIsImJ1dHRvbiIsImZvcm1zIiwibGlua0F2YXRhciIsInNhdmVBdmF0YXJCdXR0b24iLCJoYW5kbGVGb3JtTmV3QXZhdGFyU3VibWl0IiwidXNlckF2YXRhciIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXZhdGFyIiwidXNlciIsInN0eWxlIiwiZm9ybUVkaXQiLCJkZXNjcmlwdGlvbiIsInNhdmVVc2VySW5mb0J1dHRvbiIsInVzZXJOYW1lIiwidXNlckFib3V0IiwiYWJvdXQiLCJuYW1lUGxhY2UiLCJsaW5rUGxhY2UiLCJzYXZlUGxhY2VCdXR0b24iLCJoYW5kbGVGb3JtTmV3UGxhY2VTdWJtaXQiLCJjYXJkTmFtZSIsImNhcmRMaW5rIiwibmV3Q2FyZCIsInByZXBlbmQiLCJwcmV2ZW50RGVmYXVsdCIsInBhdHRlcm5NaXNtYXRjaCIsInNldEN1c3RvbVZhbGlkaXR5IiwiZGF0YXNldCIsInZhbGlkYXRpb25NZXNzYWdlIiwiaXNWYWxpZCIsInNldEV2ZW50TGlzdGVuZXJzIiwiYWxsIiwicmVzdWx0IiwiY2FyZHMiLCJhcHBlbmQiLCJzaG93Q2FyZHMiXSwic291cmNlUm9vdCI6IiJ9